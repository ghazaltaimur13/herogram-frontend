"use strict";(self.webpackChunkherogram_test_frontend=self.webpackChunkherogram_test_frontend||[]).push([[865],{3465:(e,i,r)=>{r.d(i,{Q:()=>s});const s={LOGIN:"/login",UPLOAD_FILE:"/uploadFile",READ_FILE:"/readFiles",TRACK_FILE:"/trackFiles",SIGNUP:"/signup"}},8246:(e,i,r)=>{r.r(i),r.d(i,{default:()=>_});var s=r(5043),n=r(4281),t=r(8911),o=r(9252),a=r(1596),l=r(5865),d=r(7353),c=r(8903),h=r(2110),x=r(6591),p=r(6494),u=r(2505),g=r(7392),A=r(1906),j=r(1637),m=r(4194),f=r(3768),v=r(9506),F=r(3465);const y=r(6749).l.injectEndpoints({endpoints:e=>({uploadFile:e.mutation({query:e=>({url:`${F.Q.UPLOAD_FILE}`,method:"POST",body:e}),transformResponse:e=>e}),getFiles:e.query({query:()=>`${F.Q.READ_FILE}`}),trackFile:e.mutation({query:e=>({url:`${F.Q.TRACK_FILE}`,method:"POST",body:{fileId:e}})})})}),{useUploadFileMutation:E,useGetFilesQuery:L,useTrackFileMutation:w}=y;var k=r(8076),b=r(39),U=r(9650),I=r(1806),R=r(4882),S=r(3460),D=r(579);const C=e=>{var i;let{uploadedFiles:r,isLoading:s,fetchError:n,isFetchError:t,setRefreshFiles:o}=e;const[c]=w(),h=r.map((e=>(0,D.jsxs)(k.A,{children:[(0,D.jsx)(b.A,{children:e.filename}),(0,D.jsx)(b.A,{children:e.tags.join(", ")}),(0,D.jsx)(b.A,{children:new Date(e.uploadedAt).toLocaleString()}),(0,D.jsx)(b.A,{children:e.views}),(0,D.jsx)(b.A,{children:(0,D.jsx)(A.A,{onClick:i=>{i.preventDefault(),(async(e,i)=>{try{await c(e).unwrap(),o((e=>!e)),window.open(i,"_blank","noopener,noreferrer")}catch(r){console.error("Failed to track file view:",r)}})(e.id,e.url)},sx:{textDecoration:"underline",color:"primary.main",background:"none",padding:0,"&:hover":{textDecoration:"underline"}},children:"View File"})})]},e.id)));return(0,D.jsxs)(U.A,{component:a.A,sx:{marginTop:4,maxWidth:{xs:"100%",sm:"80%"}},children:[(0,D.jsx)(l.A,{variant:"h6",align:"center",gutterBottom:!0,sx:{padding:"2rem"},children:"Uploaded Files"}),s?(0,D.jsx)(d.A,{display:"flex",justifyContent:"center",alignItems:"center",sx:{minHeight:"150px"},children:(0,D.jsx)(j.A,{})}):t&&n?(0,D.jsx)(m.A,{icon:(0,D.jsx)(v.A,{fontSize:"inherit"}),severity:"error",children:(null===n||void 0===n||null===(i=n.data)||void 0===i?void 0:i.message)||"Failed to load files."}):(0,D.jsxs)(I.A,{children:[(0,D.jsx)(R.A,{children:(0,D.jsxs)(k.A,{sx:{backgroundColor:"#ccc"},children:[(0,D.jsx)(b.A,{children:"File Name"}),(0,D.jsx)(b.A,{children:"Tags"}),(0,D.jsx)(b.A,{children:"Upload Date"}),(0,D.jsx)(b.A,{children:"File Views"}),(0,D.jsx)(b.A,{children:"Shareable Link"})]})}),(0,D.jsxs)(S.A,{children:[h," "]})]})]})},_=()=>{var e;const[i,r]=(0,s.useState)([]),[F,y]=(0,s.useState)([]),[w,k]=(0,s.useState)(!1),{data:b,error:U,isLoading:I,isError:R,refetch:S}=L(),[_,{isError:T,error:O,isSuccess:P,isLoading:W}]=E();(0,s.useEffect)((()=>{b&&y(b)}),[b]),(0,s.useEffect)((()=>{S()}),[w,S]);(0,s.useEffect)((()=>()=>{i.forEach((e=>URL.revokeObjectURL(e.preview)))}),[i]);const{getRootProps:z,getInputProps:Q}=(0,n.VB)({onDrop:e=>{const i=e.map((e=>({file:e,preview:URL.createObjectURL(e),tags:""})));r((e=>[...e,...i]))},accept:"image/*,video/*"});return(0,D.jsxs)(t.A,{direction:"column",alignItems:"center",justifyContent:"center",sx:{minHeight:{xs:"calc(100vh)",paddingTop:"1rem"}},children:[(0,D.jsx)(o.A,{component:"main",maxWidth:"xs",children:(0,D.jsxs)(a.A,{elevation:3,sx:{padding:3},children:[(0,D.jsx)(l.A,{variant:"h4",align:"center",gutterBottom:!0,children:"File Upload with Tags"}),(0,D.jsxs)(d.A,{...z({className:"dropzone"}),sx:{border:"2px dashed #0087f7",borderRadius:"5px",padding:"20px",textAlign:"center",cursor:"pointer",marginBottom:"20px"},children:[(0,D.jsx)("input",{...Q()}),(0,D.jsx)(l.A,{variant:"body1",children:"Drag 'n' drop some files here, or click to select files"})]}),(0,D.jsx)(c.Ay,{container:!0,spacing:2,children:i.map(((e,s)=>(0,D.jsx)(c.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,D.jsxs)(h.A,{children:[(0,D.jsx)(x.A,{component:e.file.type.startsWith("image/")?"img":"video",src:e.preview,controls:!e.file.type.startsWith("image/"),height:"140",alt:e.file.name}),(0,D.jsxs)(p.A,{children:[(0,D.jsx)(u.A,{fullWidth:!0,label:"Add tags",value:e.tags,onChange:e=>((e,s)=>{const n=[...i];n[e].tags=s.target.value,r(n)})(s,e)}),(0,D.jsx)(g.A,{onClick:()=>(e=>{const s=i.filter(((i,r)=>r!==e));r(s)})(s),color:"error","aria-label":"delete",children:(0,D.jsx)(f.A,{})})]})]})},s)))}),(0,D.jsx)(A.A,{variant:"contained",color:"primary",onClick:async()=>{const e=new FormData;i.forEach(((i,r)=>{e.append("files",i.file),e.append(`tags[${r}]`,i.tags)}));try{(await _(e).unwrap()).message&&(S(),r([]))}catch(U){console.error("Error uploading files:",U)}},fullWidth:!0,sx:{marginTop:2},startIcon:W&&(0,D.jsx)(j.A,{size:16}),disabled:W||0===i.length,children:W?"Uploading...":"Upload Files"}),T&&(0,D.jsx)(m.A,{icon:(0,D.jsx)(v.A,{fontSize:"inherit"}),severity:"error",children:(null===O||void 0===O||null===(e=O.data)||void 0===e?void 0:e.message)||"Failed to upload files."}),P&&(0,D.jsx)(m.A,{icon:(0,D.jsx)(v.A,{fontSize:"inherit"}),severity:"success",children:"Uploaded Successfully"})]})}),I?(0,D.jsx)(j.A,{}):(0,D.jsx)(C,{uploadedFiles:F,isLoading:I,fetchError:U,isFetchError:R,setRefreshFiles:k})]})}}}]);
//# sourceMappingURL=865.f2905604.chunk.js.map